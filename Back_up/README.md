# Домашнее задание к занятию "Резервное копирование баз данных" - `Хамуро Илья`

### Задание 1
Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

Необходимо описать, какие варианты резервного копирования подходят в случаях:

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

Приведите ответ в свободной форме.

### Ответ на задание 1
1.1. Восстановление данных в полном объёме за предыдущий день
В этом случае наиболее целесообразно использовать полное резервное копирование (Full backup).

Полная копия базы создаётся ежедневно (например, ночью).

При поломке можно быстро развернуть копию и получить состояние базы «на вчера».

Плюсы: простота, надёжность.

Минусы: занимает много места и времени.

1.2. Восстановление данных за час до поломки
Здесь потребуется более частое копирование. Возможные варианты:

Инкрементное резервное копирование (сохраняются только изменения с момента последнего бэкапа). Можно комбинировать с ежедневным полным бэкапом.

Дифференциальное копирование (сохраняются изменения с момента последнего полного бэкапа).

Использование журналов транзакций (transaction logs) — в СУБД (например, PostgreSQL или MS SQL) можно настроить «точку во времени» (Point-in-Time Recovery, PITR). Это позволяет восстановиться до конкретного момента (например, за час до сбоя).

1.3. Моментальное переключение на рабочую или починенную базу*
Такое возможно при использовании технологий репликации и кластеризации:

Master-Slave репликация — данные синхронно или асинхронно копируются с основной базы на резервную.

Failover-кластер — при отказе основной базы автоматически происходит переключение на резервный узел.

High Availability (HA) решения: Patroni (для PostgreSQL), AlwaysOn (MS SQL), Oracle RAC, Percona XtraDB Cluster (MySQL).
Это позволяет минимизировать простой и работать без потери данных практически в реальном времени.

### Задание 2

### Ответ на задание 2

В PostgreSQL для резервного копирования и восстановления используются утилиты pg_dump и pg_restore.

Создание резервной копии (дампа):

'''
  pg_dump -U username -d dbname -F c -f /backup/dbname.backup
'''

Где:

-U username — имя пользователя PostgreSQL;

-d dbname — имя базы данных;

-F c — формат «custom», который можно потом использовать с pg_restore;

-f /backup/dbname.backup — путь к файлу резервной копии.

Восстановление базы данных из резервной копии:
'''
  pg_restore -U username -d dbname -c /backup/dbname.backup
'''

Где:

-c — очистка (drop) объектов перед восстановлением;

-d dbname — база, в которую восстанавливаем;

/backup/dbname.backup — файл резервной копии.

2.1. Автоматизация процесса*

Да, автоматизация возможна и часто используется:

Скрипты (bash, PowerShell):

Написать скрипт, который запускает pg_dump по расписанию.

Добавить дату в имя файла (например, dbname_2025-09-06.backup).

Хранить несколько последних бэкапов, старые удалять.

Планировщики заданий:

В Linux — cron для запуска скрипта (например, каждый день в 02:00).

В Windows — «Планировщик заданий».

### Задание 3

### Ответ на задание 3
